<template>
  <div class="tutorial-section">
    <!-- ç¬¬ä¸€æ­¥ï¼šå®‰è£… Node.js -->
    <NodeInstallTutorial :platform="platform" :step-number="1" tool-name="Gemini CLI" />

    <!-- ç¬¬äºŒæ­¥ï¼šé…ç½®ç¯å¢ƒå˜é‡ -->
    <div class="mb-4 sm:mb-10 sm:mb-6">
      <h4
        class="mb-3 flex items-center text-lg font-semibold text-gray-800 dark:text-gray-300 sm:mb-4 sm:text-xl"
      >
        <span
          class="mr-2 flex h-6 w-6 items-center justify-center rounded-full bg-green-500 text-xs font-bold text-white sm:mr-3 sm:h-8 sm:w-8 sm:text-sm"
          >2</span
        >
        é…ç½® Gemini CLI ç¯å¢ƒå˜é‡
      </h4>
      <p class="mb-3 text-sm text-gray-700 dark:text-gray-300 sm:mb-4 sm:text-base">
        è®¾ç½®ä»¥ä¸‹ç¯å¢ƒå˜é‡ä»¥è¿æ¥åˆ°ä¸­è½¬æœåŠ¡ï¼š
      </p>

      <div class="space-y-4">
        <!-- Windows -->
        <template v-if="platform === 'windows'">
          <div
            class="rounded-lg border border-green-200 bg-white p-3 dark:border-green-700 dark:bg-gray-800 sm:p-4"
          >
            <h6 class="mb-2 text-sm font-medium text-gray-800 dark:text-gray-300 sm:text-base">
              PowerShell è®¾ç½®æ–¹æ³•
            </h6>
            <p class="mb-3 text-sm text-gray-600 dark:text-gray-400">
              åœ¨ PowerShell ä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š
            </p>
            <div
              class="overflow-x-auto rounded bg-gray-900 p-2 font-mono text-xs text-green-400 sm:p-3 sm:text-sm"
            >
              <div class="whitespace-nowrap text-gray-300">
                $env:GOOGLE_GEMINI_BASE_URL = "{{ geminiBaseUrl }}"
              </div>
              <div class="whitespace-nowrap text-gray-300">$env:GEMINI_API_KEY = "ä½ çš„APIå¯†é’¥"</div>
              <div class="whitespace-nowrap text-gray-300">
                $env:GEMINI_MODEL = "gemini-2.5-pro"
              </div>
            </div>
            <p class="mt-2 text-xs text-yellow-700 dark:text-yellow-400">
              ğŸ’¡ ä½¿ç”¨ä¸ Claude Code ç›¸åŒçš„ API å¯†é’¥å³å¯ã€‚
            </p>
          </div>

          <div
            class="rounded-lg border border-green-200 bg-white p-3 dark:border-green-700 dark:bg-gray-800 sm:p-4"
          >
            <h6 class="mb-2 text-sm font-medium text-gray-800 dark:text-gray-300 sm:text-base">
              PowerShell æ°¸ä¹…è®¾ç½®ï¼ˆç”¨æˆ·çº§ï¼‰
            </h6>
            <p class="mb-3 text-sm text-gray-600 dark:text-gray-400">
              åœ¨ PowerShell ä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š
            </p>
            <div
              class="mb-3 overflow-x-auto rounded bg-gray-900 p-2 font-mono text-xs text-green-400 sm:p-3 sm:text-sm"
            >
              <div class="mb-2"># è®¾ç½®ç”¨æˆ·çº§ç¯å¢ƒå˜é‡ï¼ˆæ°¸ä¹…ç”Ÿæ•ˆï¼‰</div>
              <div class="whitespace-nowrap text-gray-300">
                [System.Environment]::SetEnvironmentVariable("GOOGLE_GEMINI_BASE_URL", "{{
                  geminiBaseUrl
                }}", [System.EnvironmentVariableTarget]::User)
              </div>
              <div class="whitespace-nowrap text-gray-300">
                [System.Environment]::SetEnvironmentVariable("GEMINI_API_KEY", "ä½ çš„APIå¯†é’¥",
                [System.EnvironmentVariableTarget]::User)
              </div>
              <div class="whitespace-nowrap text-gray-300">
                [System.Environment]::SetEnvironmentVariable("GEMINI_MODEL", "gemini-2.5-pro",
                [System.EnvironmentVariableTarget]::User)
              </div>
            </div>
            <p class="mt-2 text-xs text-blue-700 dark:text-blue-300">
              ğŸ’¡ è®¾ç½®åéœ€è¦é‡æ–°æ‰“å¼€ PowerShell çª—å£æ‰èƒ½ç”Ÿæ•ˆã€‚
            </p>
          </div>
        </template>

        <!-- macOS / Linux -->
        <template v-else>
          <div
            class="rounded-lg border border-green-200 bg-white p-3 dark:border-green-700 dark:bg-gray-800 sm:p-4"
          >
            <h6 class="mb-2 text-sm font-medium text-gray-800 dark:text-gray-300 sm:text-base">
              ä¸´æ—¶è®¾ç½®ï¼ˆå½“å‰ä¼šè¯ï¼‰
            </h6>
            <p class="mb-3 text-sm text-gray-600 dark:text-gray-400">åœ¨ç»ˆç«¯ä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p>
            <div
              class="overflow-x-auto rounded bg-gray-900 p-2 font-mono text-xs text-green-400 sm:p-3 sm:text-sm"
            >
              <div class="whitespace-nowrap text-gray-300">
                export GOOGLE_GEMINI_BASE_URL="{{ geminiBaseUrl }}"
              </div>
              <div class="whitespace-nowrap text-gray-300">export GEMINI_API_KEY="ä½ çš„APIå¯†é’¥"</div>
              <div class="whitespace-nowrap text-gray-300">
                export GEMINI_MODEL="gemini-2.5-pro"
              </div>
            </div>
            <p class="mt-2 text-xs text-yellow-700 dark:text-yellow-400">
              ğŸ’¡ ä½¿ç”¨ä¸ Claude Code ç›¸åŒçš„ API å¯†é’¥å³å¯ã€‚
            </p>
          </div>

          <div
            class="rounded-lg border border-green-200 bg-white p-3 dark:border-green-700 dark:bg-gray-800 sm:p-4"
          >
            <h6 class="mb-2 text-sm font-medium text-gray-800 dark:text-gray-300 sm:text-base">
              æ°¸ä¹…è®¾ç½®ï¼ˆShell é…ç½®æ–‡ä»¶ï¼‰
            </h6>
            <p class="mb-3 text-sm text-gray-600 dark:text-gray-400">
              å°†ä»¥ä¸‹å†…å®¹æ·»åŠ åˆ°ä½ çš„ shell é…ç½®æ–‡ä»¶ä¸­ï¼ˆ{{
                platform === 'macos' ? '~/.zshrc' : '~/.bashrc'
              }}ï¼‰ï¼š
            </p>
            <div
              class="mb-3 overflow-x-auto rounded bg-gray-900 p-2 font-mono text-xs text-green-400 sm:p-3 sm:text-sm"
            >
              <div class="whitespace-nowrap text-gray-300">
                export GOOGLE_GEMINI_BASE_URL="{{ geminiBaseUrl }}"
              </div>
              <div class="whitespace-nowrap text-gray-300">export GEMINI_API_KEY="ä½ çš„APIå¯†é’¥"</div>
              <div class="whitespace-nowrap text-gray-300">
                export GEMINI_MODEL="gemini-2.5-pro"
              </div>
            </div>
            <p class="mb-3 text-sm text-gray-600 dark:text-gray-400">ç„¶åæ‰§è¡Œï¼š</p>
            <div
              class="overflow-x-auto rounded bg-gray-900 p-2 font-mono text-xs text-green-400 sm:p-3 sm:text-sm"
            >
              <div class="whitespace-nowrap text-gray-300">
                source {{ platform === 'macos' ? '~/.zshrc' : '~/.bashrc' }}
              </div>
            </div>
          </div>
        </template>

        <!-- éªŒè¯ -->
        <div
          class="rounded-lg border border-green-200 bg-green-50 p-3 dark:border-green-500/40 dark:bg-green-950/30 sm:p-4"
        >
          <h6 class="mb-2 font-medium text-green-800 dark:text-green-300">
            éªŒè¯ Gemini CLI ç¯å¢ƒå˜é‡
          </h6>
          <p class="mb-3 text-sm text-green-700 dark:text-green-300">
            {{ platform === 'windows' ? 'åœ¨ PowerShell ä¸­éªŒè¯ï¼š' : 'åœ¨ç»ˆç«¯ä¸­éªŒè¯ï¼š' }}
          </p>
          <div
            class="space-y-1 overflow-x-auto rounded bg-gray-900 p-2 font-mono text-xs text-green-400 sm:p-3 sm:text-sm"
          >
            <template v-if="platform === 'windows'">
              <div class="whitespace-nowrap text-gray-300">echo $env:GOOGLE_GEMINI_BASE_URL</div>
              <div class="whitespace-nowrap text-gray-300">echo $env:GEMINI_API_KEY</div>
              <div class="whitespace-nowrap text-gray-300">echo $env:GEMINI_MODEL</div>
            </template>
            <template v-else>
              <div class="whitespace-nowrap text-gray-300">echo $GOOGLE_GEMINI_BASE_URL</div>
              <div class="whitespace-nowrap text-gray-300">echo $GEMINI_API_KEY</div>
              <div class="whitespace-nowrap text-gray-300">echo $GEMINI_MODEL</div>
            </template>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>

<script setup>
import { useTutorialUrls } from '@/utils/useTutorialUrls'
import NodeInstallTutorial from './NodeInstallTutorial.vue'

defineProps({
  platform: {
    type: String,
    required: true,
    validator: (value) => ['windows', 'macos', 'linux'].includes(value)
  }
})

const { geminiBaseUrl } = useTutorialUrls()
</script>
